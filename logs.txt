g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c test/dealer_softmax.cpp -o test/dealer_softmax.o
g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c mpc/mpc.cpp -o mpc/mpc.o
g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c test/nn/test_softmax.cpp -o test/nn/test_softmax.o
g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c utils/comm.cpp -o utils/comm.o
g++ -pthread -o test/dealer_softmax test/dealer_softmax.o mpc/mpc.o
g++ -pthread -o test/nn/test_softmax test/nn/test_softmax.o mpc/mpc.o utils/comm.o
Softmax Dealer starting...
generate_zero_extend_randomness: 0
generate_zero_extend_randomness: 1
generate_zero_extend_randomness: 2
generate_zero_extend_randomness: 3
generate_zero_extend_randomness: 4
generate_zero_extend_randomness: 5
generate_zero_extend_randomness: 6
generate_zero_extend_randomness: 7
generate_zero_extend_randomness: 8
generate_zero_extend_randomness: 9
Softmax Dealer finished successfully.
[Party 1] Connecting to Party 0 on port 9002...
[Party 0] Listening for Party 1 on port 9002...
[Party 1] <-> [Party 0] connection established.
[Party 0] <-> [Party 1] connection established.
--- Testing Softmax Layer for Party 1/2 ---
--- Testing Softmax Layer for Party 0/2 ---
Softmax Layer initialized
Softmax Layer initialized
Randomness loaded
Executing backward pass
Randomness loaded
Executing backward pass
Backward pass executed
Backward pass executed
Party 1 Softmax Layer test passed!
input_plain_n:         0 -0.200001 -0.400001      -0.6      -0.8
      0.2         0 -0.200001 -0.400001      -0.6
      0.4       0.2         0 -0.200001 -0.400001
 0.599999       0.4       0.2         0 -0.200001
 0.799999  0.599999       0.4       0.2         0
inp_mul_temp: -14.2963 -17.1556 -20.0148 -22.8741 -25.7333
 -11.437 -14.2963 -17.1556 -20.0148 -22.8741
-8.57778  -11.437 -14.2963 -17.1556 -20.0148
-5.71852 -8.57778  -11.437 -14.2963 -17.1556
-2.85927 -5.71852 -8.57778  -11.437 -14.2963
exp_inp_mul_temp:           0           0           0           0           0
1.04904e-05           0           0           0           0
0.000187874 1.04904e-05           0           0           0
 0.00328445 0.000187874 1.04904e-05           0           0
  0.0573101  0.00328445 0.000187874 1.04904e-05           0
inverse_concat: 10.0001
9.99901
9.98026
9.66349
 6.2192
 6.2192
9.66349
9.98026
9.99901
10.0001
softmax_row:           0           0           0           0           0
0.000103951           0           0           0           0
 0.00187492 0.000103951           0           0           0
  0.0317392  0.00181484 0.000101089           0           0
   0.356422   0.0204258  0.00116825 6.48499e-05           0
softmax_col:           0           0           0           0           0
6.48499e-05           0           0           0           0
 0.00116825 0.000101089           0           0           0
  0.0204258  0.00181484 0.000103951           0           0
   0.356422   0.0317392  0.00187492 0.000103951           0
--------BACKWARD TEST--------
Reconstructed Output:
    -1.00001 -9.53674e-06 -8.58307e-06 -8.58307e-06 -9.53674e-06
 9.25064e-05           -1 -1.04904e-05 -1.04904e-05 -1.14441e-05
    0.001894  9.34601e-05           -1 -1.04904e-05 -1.04904e-05
   0.0328226   0.00187492  9.25064e-05     -1.00001 -1.14441e-05
    0.469857    0.0270615   0.00153732  7.53403e-05     -1.00001
Expected Output:
         -1           0           0           0           0
8.39233e-05          -1           0           0           0
 0.00152111 0.000102043          -1           0           0
   0.026082  0.00181484 0.000102043          -1           0
   0.356422    0.026082  0.00152111 8.39233e-05          -1
Softmax backward verification passed.
Party 0 Softmax Layer test passed!
dtao_m_rec: -3.64333e+06  3.25435e+06  6.58552e+06 -1.26318e+06  1.89415e+06
-4.00364e+06   6.5456e+06 -3.05928e+06  3.99427e+06 -6.74118e+06
-4.54908e+06       685220 -7.89279e+06 -5.28082e+06  7.82892e+06
-3.95319e+06      -455949       681117  5.28864e+06  1.73214e+06
 5.30416e+06 -8.00293e+06       827831 -4.96389e+06  1.51144e+06
dtao_m_rec: -3.64333e+06  3.25435e+06  6.58552e+06 -1.26318e+06  1.89415e+06
-4.00364e+06   6.5456e+06 -3.05928e+06  3.99427e+06 -6.74118e+06
-4.54908e+06       685220 -7.89279e+06 -5.28082e+06  7.82892e+06
-3.95319e+06      -455949       681117  5.28864e+06  1.73214e+06
 5.30416e+06 -8.00293e+06       827831 -4.96389e+06  1.51144e+06
Softmax Layer updated
Softmax Layer updated
