g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c test/dealer_l2norm_parallel.cpp -o test/dealer_l2norm_parallel.o
g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c mpc/mpc.cpp -o mpc/mpc.o
g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c test/nn/test_l2norm_parallel.cpp -o test/nn/test_l2norm_parallel.o
g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c utils/comm.cpp -o utils/comm.o
g++ -pthread -o test/dealer_l2norm_parallel test/dealer_l2norm_parallel.o mpc/mpc.o
g++ -pthread -o test/nn/test_l2norm_parallel test/nn/test_l2norm_parallel.o mpc/mpc.o utils/comm.o
Dealer for L2NormParallelLayer starting...
Total randomness size per party: 65120 bytes.
Generating randomness
Checking randomness size
Dealer finished successfully.
[Party 0] Listening for Party 1 on port 9002...
[Party 1] Connecting to Party 0 on port 9002...
[Party 1] <-> [Party 0] connection established.
[Party 0] <-> [Party 1] connection established.
--- Testing L2NormParallel Layer Forward Pass for Party 1/2 ---
--- Testing L2NormParallel Layer Forward Pass for Party 0/2 ---
L2NormParallel Layer initialized
L2NormParallel Layer initialized
input is         0 0.0999908  0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994
0.0999908  0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1
 0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999
 0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999       1.2
 0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999       1.2   1.29999 and         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012 -0.800003 -0.900009
0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012 -0.800003
 0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012
 0.299988  0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006
 0.399994  0.299988  0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5
Loading Randomness
input is         0 0.0999908  0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994
0.0999908  0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1
 0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999
 0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999       1.2
 0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999       1.2   1.29999 and         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012 -0.800003 -0.900009
0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012 -0.800003
 0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012
 0.299988  0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006
 0.399994  0.299988  0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5
Loading Randomness
Randomness loaded
Executing forward pass
Randomness loaded
Executing forward pass
Forward pass executed
Forward pass executed

--- Testing L2NormParallel Layer Backward Pass for Party 1/2 ---
incoming_grad_plain:          0 -0.0499878 -0.0999908  -0.149994  -0.199997
 0.0499878          0 -0.0499878 -0.0999908  -0.149994
 0.0999908  0.0499878          0 -0.0499878 -0.0999908
  0.149994  0.0999908  0.0499878          0 -0.0499878
  0.199997   0.149994  0.0999908  0.0499878          0
incoming_grad_plain_T:          0  0.0499878  0.0999908   0.149994   0.199997
-0.0499878          0  0.0499878  0.0999908   0.149994
-0.0999908 -0.0499878          0  0.0499878  0.0999908
 -0.149994 -0.0999908 -0.0499878          0  0.0499878
 -0.199997  -0.149994 -0.0999908 -0.0499878          0
--------FORWARD TEST--------
Reconstructed Output:
-1.52588e-05    0.0592804     0.118591     0.177887     0.237183     0.296494     0.355789     0.415085     0.474396     0.533691    0.0509949     0.102005     0.153015     0.204025     0.255035      0.30603      0.35704     0.408051     0.459061     0.510071     0.088974     0.133469     0.177979     0.222473     0.266968     0.311462     0.355957     0.400467     0.444962     0.489456     0.118118     0.157501     0.196884     0.236267     0.275635     0.315018     0.354401     0.393784     0.433167     0.472534     0.140884     0.176102     0.211334     0.246552     0.281769     0.317001     0.352219     0.387436     0.422653     0.457886
-1.52588e-05   -0.0593109    -0.118622    -0.177933    -0.237228    -0.296524    -0.355835    -0.415131    -0.474426    -0.533737    0.0696106 -1.52588e-05   -0.0696411    -0.139282    -0.208908    -0.278564     -0.34819    -0.417816    -0.487457    -0.557083     0.165909    0.0829315 -1.52588e-05   -0.0829773    -0.165939    -0.248901    -0.331863    -0.414795    -0.497757    -0.580719     0.293182     0.195465    0.0977173 -1.52588e-05   -0.0977478    -0.195511    -0.293228    -0.390976    -0.488708    -0.586456     0.431473     0.323593     0.215729     0.107849 -1.52588e-05    -0.107895    -0.215775    -0.323639    -0.431519    -0.539383
Expected Output:
         0  0.0592194   0.118454   0.177689   0.236923   0.296173   0.355392   0.414642   0.473862   0.533112  0.0509491   0.101913   0.152878   0.203842   0.254822   0.305771    0.35675     0.4077   0.458679   0.509644  0.0889893   0.133484   0.177994   0.222488   0.266983   0.311493   0.355988   0.400482   0.444992   0.489487   0.118118   0.157486   0.196869   0.236237    0.27562   0.314987    0.35437   0.393738   0.433121   0.472488   0.140976   0.176224   0.211456   0.246704   0.281952     0.3172   0.352448   0.387695   0.422943   0.458176
         0 -0.0592346  -0.118469  -0.177704  -0.236938  -0.296158  -0.355408  -0.414642  -0.473862  -0.533112  0.0698242          0 -0.0698395  -0.139679  -0.209518  -0.279373  -0.349197  -0.419052  -0.488892  -0.558731   0.166077  0.0830231          0 -0.0830383  -0.166092   -0.24913  -0.332184  -0.415207   -0.49826  -0.581314   0.292755   0.195175    0.09758          0 -0.0975952   -0.19519   -0.29277  -0.390366  -0.487946  -0.585541   0.433853   0.325378   0.216919   0.108444          0  -0.108459  -0.216934  -0.325394  -0.433868  -0.542313
L2NormParallel forward verification passed.

--- Testing L2NormParallel Layer Backward Pass for Party 0/2 ---
incoming_grad_plain:          0 -0.0499878 -0.0999908  -0.149994  -0.199997
 0.0499878          0 -0.0499878 -0.0999908  -0.149994
 0.0999908  0.0499878          0 -0.0499878 -0.0999908
  0.149994  0.0999908  0.0499878          0 -0.0499878
  0.199997   0.149994  0.0999908  0.0499878          0
incoming_grad_plain_T:          0  0.0499878  0.0999908   0.149994   0.199997
-0.0499878          0  0.0499878  0.0999908   0.149994
-0.0999908 -0.0499878          0  0.0499878  0.0999908
 -0.149994 -0.0999908 -0.0499878          0  0.0499878
 -0.199997  -0.149994 -0.0999908 -0.0499878          0
Party 1 L2NormParallel Layer test passed!
--------IMAGE VERIFICATION----------
dI_reconstructed: -0.0889587 0.00590515   0.100815   0.195694   0.290573   0.385483   0.480362   0.575256   0.670135    0.76503
 0.0191193  0.0765228   0.133896   0.191299   0.248688   0.306076   0.363464   0.420853   0.478256   0.535645
0.00668335  0.0211487   0.035614  0.0500946  0.0645752  0.0790405  0.0935059   0.107986   0.122452   0.136917
 -0.124023  -0.155502  -0.186996  -0.218491  -0.249969  -0.281479  -0.312943  -0.344452  -0.375931  -0.407425
 -0.369781   -0.44902  -0.528259  -0.607483  -0.686707  -0.765961  -0.845184  -0.924408   -1.00365   -1.08289
dI_final_full_bw: -0.0888519 0.00590515   0.100677    0.19545   0.290222    0.38501   0.479767   0.574554   0.669327   0.764099
  0.019104  0.0764465   0.133774   0.191116   0.248444   0.305786   0.363129   0.420441   0.477798   0.535126
0.00666809  0.0211487  0.0355988  0.0500793  0.0645447    0.07901  0.0934753   0.107941   0.122406   0.136871
 -0.124008  -0.155502  -0.187012  -0.218491  -0.249985  -0.281479  -0.312973  -0.344467  -0.375961  -0.407455
 -0.370026   -0.44931  -0.528595  -0.607895  -0.687164  -0.766464  -0.845764  -0.925034   -1.00433   -1.08362
text plain ext          0 -0.0999908  -0.199997  -0.299988  -0.399994       -0.5  -0.599991  -0.699997  -0.799988  -0.899994
 0.0999908          0 -0.0999908  -0.199997  -0.299988  -0.399994       -0.5  -0.599991  -0.699997  -0.799988
  0.199997  0.0999908          0 -0.0999908  -0.199997  -0.299988  -0.399994       -0.5  -0.599991  -0.699997
  0.299988   0.199997  0.0999908          0 -0.0999908  -0.199997  -0.299988  -0.399994       -0.5  -0.599991
  0.399994   0.299988   0.199997  0.0999908          0 -0.0999908  -0.199997  -0.299988  -0.399994       -0.5
dT_plain:     0.149979    0.0999908    0.0499878            0   -0.0500031   -0.0999908    -0.149994    -0.199982    -0.249985    -0.299988
   0.0999756    0.0749817    0.0499878    0.0249939 -1.52588e-05   -0.0250092   -0.0500031   -0.0749969    -0.100006       -0.125
   0.0499878    0.0499878    0.0499878    0.0499878    0.0499878    0.0499878    0.0499878    0.0499878    0.0499878    0.0499878
-1.52588e-05    0.0249939    0.0499878    0.0749817    0.0999756     0.124985     0.149979     0.174973     0.199982     0.224976
  -0.0500031            0    0.0499878    0.0999908     0.149979     0.199982     0.249985     0.299973     0.349976     0.399963
dT_final_full_bw:    0.0888367    0.0592194    0.0296021            0   -0.0296326   -0.0592346   -0.0888519    -0.118469    -0.148087    -0.177704
    0.069809    0.0523529    0.0348969    0.0174408 -1.52588e-05   -0.0174713   -0.0349274   -0.0523834   -0.0698547   -0.0873108
   0.0415039    0.0415039    0.0415039    0.0415039    0.0415039    0.0415039    0.0415039    0.0415039    0.0415039    0.0415039
-1.52588e-05    0.0243835    0.0487823    0.0731659    0.0975647     0.121964     0.146362     0.170746      0.19516     0.219543
   -0.054245            0    0.0542145     0.108444     0.162659     0.216904     0.271133     0.325348     0.379593     0.433807
proj_T_plain_full_bw:            0   -0.0100098   -0.0100098            0     0.019989    0.0499878    0.0899811     0.139984     0.199982     0.269974
  0.00999451            0  -0.00500488  -0.00500488            0   0.00999451    0.0249939    0.0449829    0.0699921    0.0999908
  0.00999451   0.00498962            0  -0.00500488   -0.0100098   -0.0149994   -0.0200043   -0.0249939   -0.0299988   -0.0350037
-1.52588e-05   0.00498962   0.00498962            0   -0.0100098   -0.0250092   -0.0449982   -0.0699921   -0.0999908    -0.134995
  -0.0200043            0   0.00999451   0.00999451            0   -0.0200043   -0.0500031   -0.0899963    -0.139999    -0.199982
term_plain:          0 -0.0749817  -0.149979   -0.22496  -0.299957  -0.374939  -0.449921  -0.524918  -0.599899  -0.674896
 0.0249786          0 -0.0249939 -0.0499878 -0.0749817 -0.0999756  -0.124969  -0.149963  -0.174957  -0.199951
-0.0250092 -0.0125122          0  0.0124969  0.0249939  0.0375061  0.0500031  0.0625153  0.0750122  0.0875092
 -0.112518 -0.0750122 -0.0375061          0  0.0374908  0.0749969   0.112503   0.150009   0.187515   0.225006
 -0.199997  -0.149994  -0.100006 -0.0500031          0  0.0499878  0.0999908   0.149994   0.199997       0.25
dT_plain:     0.149979     0.174973     0.199966      0.22496     0.249954     0.274948     0.299927     0.324936     0.349915     0.374908
   0.0749969    0.0749817    0.0749817    0.0749817    0.0749664    0.0749664    0.0749664    0.0749664    0.0749512    0.0749512
   0.0749969       0.0625    0.0499878    0.0374908    0.0249939    0.0124817 -1.52588e-05   -0.0125275   -0.0250244   -0.0375214
    0.112503     0.100006    0.0874939    0.0749817    0.0624847    0.0499878    0.0374756    0.0249634    0.0124664 -3.05176e-05
    0.149994     0.149994     0.149994     0.149994     0.149979     0.149994     0.149994     0.149979     0.149979     0.149963
dT_final_full_bw:    0.0888367     0.103638     0.118439      0.13324     0.148041     0.162857     0.177643     0.192459      0.20726     0.222061
   0.0523682    0.0523529    0.0523529    0.0523529    0.0523529    0.0523529    0.0523529    0.0523529    0.0523376    0.0523376
   0.0622711    0.0518951    0.0415039    0.0311279     0.020752    0.0103607 -1.52588e-05   -0.0104065   -0.0207825   -0.0311737
    0.109787      0.09758    0.0853729    0.0731659    0.0609741    0.0487823    0.0365601     0.024353    0.0121613 -3.05176e-05
    0.162689     0.162689     0.162689     0.162689     0.162659     0.162689     0.162689     0.162659     0.162659     0.162643
--------TEXT VERIFICATION----------L2NormParallel backward verification passed.
Expected Gradient:
   0.0888367     0.103638     0.118439      0.13324     0.148041     0.162857     0.177643     0.192459      0.20726     0.222061
   0.0523682    0.0523529    0.0523529    0.0523529    0.0523529    0.0523529    0.0523529    0.0523529    0.0523376    0.0523376
   0.0622711    0.0518951    0.0415039    0.0311279     0.020752    0.0103607 -1.52588e-05   -0.0104065   -0.0207825   -0.0311737
    0.109787      0.09758    0.0853729    0.0731659    0.0609741    0.0487823    0.0365601     0.024353    0.0121613 -3.05176e-05
    0.162689     0.162689     0.162689     0.162689     0.162659     0.162689     0.162689     0.162659     0.162659     0.162643
Reconstructed Gradient:
   0.0889435      0.10376     0.118576     0.133392     0.148224      0.16304     0.177856     0.192688     0.207504     0.222321
   0.0522156    0.0522156    0.0522003    0.0521851    0.0521698    0.0521545    0.0521545    0.0521393     0.052124    0.0521393
   0.0621948    0.0518341    0.0414734    0.0310974    0.0207062    0.0103607 -3.05176e-05   -0.0104218   -0.0207977   -0.0311584
     0.10997    0.0977478    0.0855103     0.073288    0.0610657    0.0488281    0.0366058    0.0243835    0.0121307 -9.15527e-05
    0.161865     0.161835     0.161819     0.161804     0.161789     0.161758     0.161758     0.161758     0.161728     0.161743
Party 0 L2NormParallel Layer test passed!
