g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c test/dealer_l2norm_parallel.cpp -o test/dealer_l2norm_parallel.o
g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c mpc/mpc.cpp -o mpc/mpc.o
g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c test/nn/test_l2norm_parallel.cpp -o test/nn/test_l2norm_parallel.o
g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c utils/comm.cpp -o utils/comm.o
g++ -pthread -o test/dealer_l2norm_parallel test/dealer_l2norm_parallel.o mpc/mpc.o
g++ -pthread -o test/nn/test_l2norm_parallel test/nn/test_l2norm_parallel.o mpc/mpc.o utils/comm.o
Dealer for L2NormParallelLayer starting...
Total randomness size per party: 66720 bytes.
Generating randomness
Checking randomness size
Dealer finished successfully.
[Party 0] Listening for Party 1 on port 9002...
[Party 1] Connecting to Party 0 on port 9002...
[Party 1] <-> [Party 0] connection established.
[Party 0] <-> [Party 1] connection established.
--- Testing L2NormParallel Layer Forward Pass for Party 1/2 ---
--- Testing L2NormParallel Layer Forward Pass for Party 0/2 ---
L2NormParallel Layer initialized
L2NormParallel Layer initialized
input is         0 0.0999908  0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994
0.0999908  0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1
 0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999
 0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999       1.2
 0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999       1.2   1.29999 and         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012 -0.800003 -0.900009
0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012 -0.800003
 0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012
 0.299988  0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006
 0.399994  0.299988  0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5
Loading Randomness
input is         0 0.0999908  0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994
0.0999908  0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1
 0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999
 0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999       1.2
 0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999       1.2   1.29999 and         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012 -0.800003 -0.900009
0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012 -0.800003
 0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012
 0.299988  0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006
 0.399994  0.299988  0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5
Loading Randomness
Randomness loaded
Executing forward pass
Randomness loaded
Executing forward pass
Forward pass executed
Forward pass executed

--- Testing L2NormParallel Layer Backward Pass for Party 1/2 ---
incoming_grad_plain:          0 -0.0499878 -0.0999908  -0.149994  -0.199997
 0.0499878          0 -0.0499878 -0.0999908  -0.149994
 0.0999908  0.0499878          0 -0.0499878 -0.0999908
  0.149994  0.0999908  0.0499878          0 -0.0499878
  0.199997   0.149994  0.0999908  0.0499878          0
incoming_grad_plain_T:          0  0.0499878  0.0999908   0.149994   0.199997
-0.0499878          0  0.0499878  0.0999908   0.149994
-0.0999908 -0.0499878          0  0.0499878  0.0999908
 -0.149994 -0.0999908 -0.0499878          0  0.0499878
 -0.199997  -0.149994 -0.0999908 -0.0499878          0
--------FORWARD TEST--------
Reconstructed Output:
-0.998169 -0.992126 -0.956711 -0.867065 -0.676086
-0.996338  -0.97998 -0.930466 -0.822205  -0.61058
-0.988632 -0.964615 -0.904785 -0.783188 -0.557388
-0.979477 -0.949631  -0.88205 -0.750549 -0.514511
 -0.97084 -0.936417 -0.862778 -0.723618 -0.479813
Expected Output:
-0.999969 -0.992874 -0.959213 -0.867111 -0.674622
-0.996201 -0.978836 -0.931107 -0.820663 -0.608093
-0.988434  -0.96344 -0.905365 -0.781693 -0.555069
-0.979568  -0.94873 -0.882858 -0.749313 -0.512512
-0.970779 -0.935394 -0.863434 -0.722321 -0.477875
L2NormParallel forward verification passed.

--- Testing L2NormParallel Layer Backward Pass for Party 0/2 ---
incoming_grad_plain:          0 -0.0499878 -0.0999908  -0.149994  -0.199997
 0.0499878          0 -0.0499878 -0.0999908  -0.149994
 0.0999908  0.0499878          0 -0.0499878 -0.0999908
  0.149994  0.0999908  0.0499878          0 -0.0499878
  0.199997   0.149994  0.0999908  0.0499878          0
incoming_grad_plain_T:          0  0.0499878  0.0999908   0.149994   0.199997
-0.0499878          0  0.0499878  0.0999908   0.149994
-0.0999908 -0.0499878          0  0.0499878  0.0999908
 -0.149994 -0.0999908 -0.0499878          0  0.0499878
 -0.199997  -0.149994 -0.0999908 -0.0499878          0
Party 1 L2NormParallel Layer test passed!
--------IMAGE VERIFICATION----------
dI_reconstructed: -0.0887146 0.00588989   0.100525   0.195145   0.289795   0.384445    0.47905   0.573685   0.668304   0.762924
 0.0191193  0.0764771    0.13382   0.191193    0.24855   0.305908   0.363266   0.420639   0.477997    0.53537
0.00666809  0.0211487  0.0356293  0.0501251  0.0645905   0.079071  0.0935364   0.108017   0.122498   0.136963
 -0.124023  -0.155518  -0.187012  -0.218475  -0.249985  -0.281464  -0.312958  -0.344467  -0.375946   -0.40744
 -0.370102  -0.449417  -0.528702  -0.608017  -0.687317  -0.766617  -0.845932  -0.925232   -1.00455   -1.08383
dI_final_full_bw: -0.0888519 0.00590515   0.100677    0.19545   0.290222    0.38501   0.479767   0.574554   0.669327   0.764099
  0.019104  0.0764465   0.133774   0.191116   0.248444   0.305786   0.363129   0.420441   0.477798   0.535126
0.00666809  0.0211487  0.0355988  0.0500793  0.0645447    0.07901  0.0934753   0.107941   0.122406   0.136871
 -0.124008  -0.155502  -0.187012  -0.218491  -0.249985  -0.281479  -0.312973  -0.344467  -0.375961  -0.407455
 -0.370026   -0.44931  -0.528595  -0.607895  -0.687164  -0.766464  -0.845764  -0.925034   -1.00433   -1.08362
text plain ext          0 -0.0999908  -0.199997  -0.299988  -0.399994       -0.5  -0.599991  -0.699997  -0.799988  -0.899994
 0.0999908          0 -0.0999908  -0.199997  -0.299988  -0.399994       -0.5  -0.599991  -0.699997  -0.799988
  0.199997  0.0999908          0 -0.0999908  -0.199997  -0.299988  -0.399994       -0.5  -0.599991  -0.699997
  0.299988   0.199997  0.0999908          0 -0.0999908  -0.199997  -0.299988  -0.399994       -0.5  -0.599991
  0.399994   0.299988   0.199997  0.0999908          0 -0.0999908  -0.199997  -0.299988  -0.399994       -0.5
dT_plain:     0.149979    0.0999908    0.0499878            0   -0.0500031   -0.0999908    -0.149994    -0.199982    -0.249985    -0.299988
   0.0999756    0.0749817    0.0499878    0.0249939 -1.52588e-05   -0.0250092   -0.0500031   -0.0749969    -0.100006       -0.125
   0.0499878    0.0499878    0.0499878    0.0499878    0.0499878    0.0499878    0.0499878    0.0499878    0.0499878    0.0499878
-1.52588e-05    0.0249939    0.0499878    0.0749817    0.0999756     0.124985     0.149979     0.174973     0.199982     0.224976
  -0.0500031            0    0.0499878    0.0999908     0.149979     0.199982     0.249985     0.299973     0.349976     0.399963
dT_final_full_bw:    0.0888367    0.0592194    0.0296021            0   -0.0296326   -0.0592346   -0.0888519    -0.118469    -0.148087    -0.177704
    0.069809    0.0523529    0.0348969    0.0174408 -1.52588e-05   -0.0174713   -0.0349274   -0.0523834   -0.0698547   -0.0873108
   0.0415039    0.0415039    0.0415039    0.0415039    0.0415039    0.0415039    0.0415039    0.0415039    0.0415039    0.0415039
-1.52588e-05    0.0243835    0.0487823    0.0731659    0.0975647     0.121964     0.146362     0.170746      0.19516     0.219543
   -0.054245            0    0.0542145     0.108444     0.162659     0.216904     0.271133     0.325348     0.379593     0.433807
proj_T_plain_full_bw:            0   -0.0100098   -0.0100098            0     0.019989    0.0499878    0.0899811     0.139984     0.199982     0.269974
  0.00999451            0  -0.00500488  -0.00500488            0   0.00999451    0.0249939    0.0449829    0.0699921    0.0999908
  0.00999451   0.00498962            0  -0.00500488   -0.0100098   -0.0149994   -0.0200043   -0.0249939   -0.0299988   -0.0350037
-1.52588e-05   0.00498962   0.00498962            0   -0.0100098   -0.0250092   -0.0449982   -0.0699921   -0.0999908    -0.134995
  -0.0200043            0   0.00999451   0.00999451            0   -0.0200043   -0.0500031   -0.0899963    -0.139999    -0.199982
term_plain:          0 -0.0749817  -0.149979   -0.22496  -0.299957  -0.374939  -0.449921  -0.524918  -0.599899  -0.674896
 0.0249786          0 -0.0249939 -0.0499878 -0.0749817 -0.0999756  -0.124969  -0.149963  -0.174957  -0.199951
-0.0250092 -0.0125122          0  0.0124969  0.0249939  0.0375061  0.0500031  0.0625153  0.0750122  0.0875092
 -0.112518 -0.0750122 -0.0375061          0  0.0374908  0.0749969   0.112503   0.150009   0.187515   0.225006
 -0.199997  -0.149994  -0.100006 -0.0500031          0  0.0499878  0.0999908   0.149994   0.199997       0.25
dT_plain:     0.149979     0.174973     0.199966      0.22496     0.249954     0.274948     0.299927     0.324936     0.349915     0.374908
   0.0749969    0.0749817    0.0749817    0.0749817    0.0749664    0.0749664    0.0749664    0.0749664    0.0749512    0.0749512
   0.0749969       0.0625    0.0499878    0.0374908    0.0249939    0.0124817 -1.52588e-05   -0.0125275   -0.0250244   -0.0375214
    0.112503     0.100006    0.0874939    0.0749817    0.0624847    0.0499878    0.0374756    0.0249634    0.0124664 -3.05176e-05
    0.149994     0.149994     0.149994     0.149994     0.149979     0.149994     0.149994     0.149979     0.149979     0.149963
dT_final_full_bw:    0.0888367     0.103638     0.118439      0.13324     0.148041     0.162857     0.177643     0.192459      0.20726     0.222061
   0.0523682    0.0523529    0.0523529    0.0523529    0.0523529    0.0523529    0.0523529    0.0523529    0.0523376    0.0523376
   0.0622711    0.0518951    0.0415039    0.0311279     0.020752    0.0103607 -1.52588e-05   -0.0104065   -0.0207825   -0.0311737
    0.109787      0.09758    0.0853729    0.0731659    0.0609741    0.0487823    0.0365601     0.024353    0.0121613 -3.05176e-05
    0.162689     0.162689     0.162689     0.162689     0.162659     0.162689     0.162689     0.162659     0.162659     0.162643
--------TEXT VERIFICATION----------L2NormParallel backward verification passed.
Expected Gradient:
   0.0888367     0.103638     0.118439      0.13324     0.148041     0.162857     0.177643     0.192459      0.20726     0.222061
   0.0523682    0.0523529    0.0523529    0.0523529    0.0523529    0.0523529    0.0523529    0.0523529    0.0523376    0.0523376
   0.0622711    0.0518951    0.0415039    0.0311279     0.020752    0.0103607 -1.52588e-05   -0.0104065   -0.0207825   -0.0311737
    0.109787      0.09758    0.0853729    0.0731659    0.0609741    0.0487823    0.0365601     0.024353    0.0121613 -3.05176e-05
    0.162689     0.162689     0.162689     0.162689     0.162659     0.162689     0.162689     0.162659     0.162659     0.162643
Reconstructed Gradient:
   0.0888062     0.103607     0.118423     0.133209      0.14801     0.162796     0.177612     0.192398     0.207199     0.221985
   0.0524139    0.0523987    0.0523834    0.0523987    0.0523987    0.0523834    0.0523834    0.0523682    0.0523834    0.0523529
   0.0622253    0.0518188    0.0414581    0.0310669    0.0206909    0.0103149 -6.10352e-05    -0.010437    -0.020813    -0.031189
    0.109955    0.0977325     0.085495    0.0732574    0.0610504    0.0488281    0.0365906    0.0243683     0.012146 -7.62939e-05
    0.163345     0.163315     0.163315     0.163315     0.163284     0.163254     0.163254     0.163239     0.163239     0.163193
Party 0 L2NormParallel Layer test passed!
