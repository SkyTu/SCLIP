g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c test/dealer_l2norm_parallel.cpp -o test/dealer_l2norm_parallel.o
g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c mpc/mpc.cpp -o mpc/mpc.o
g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c test/nn/test_l2norm_parallel.cpp -o test/nn/test_l2norm_parallel.o
g++ -std=c++17 -pthread -I./utils -I./mpc -I./ -I/usr/include/eigen3 -c utils/comm.cpp -o utils/comm.o
g++ -pthread -o test/dealer_l2norm_parallel test/dealer_l2norm_parallel.o mpc/mpc.o
g++ -pthread -o test/nn/test_l2norm_parallel test/nn/test_l2norm_parallel.o mpc/mpc.o utils/comm.o
Dealer for L2NormParallelLayer starting...
Total randomness size per party: 36720 bytes.
Generating randomness
Checking randomness size
Dealer finished successfully.
[Party 0] Listening for Party 1 on port 9002...
[Party 1] Connecting to Party 0 on port 9002...
[Party 1] <-> [Party 0] connection established.
[Party 0] <-> [Party 1] connection established.
--- Testing L2NormParallel Layer Forward Pass for Party 1/2 ---
--- Testing L2NormParallel Layer Forward Pass for Party 0/2 ---
L2NormParallel Layer initialized
L2NormParallel Layer initialized
Loading Randomness
Loading Randomness
Randomness loaded
Executing forward pass
Randomness loaded
Executing forward pass
all_share reconstructed is         0 0.0999908  0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994 0.0999908  0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1  0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999       1.2  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999       1.2   1.29999
        0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012 -0.800003 -0.900009 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012 -0.800003  0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012  0.299988  0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006  0.399994  0.299988  0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5
all_share reconstructed is         0 0.0999908  0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994 0.0999908  0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1  0.199997  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999  0.299988  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999       1.2  0.399994       0.5  0.599991  0.699997  0.799988  0.899994         1   1.09999       1.2   1.29999
        0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012 -0.800003 -0.900009 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012 -0.800003  0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006 -0.700012  0.299988  0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5 -0.600006  0.399994  0.299988  0.199997 0.0999908         0 -0.100006 -0.200012 -0.300003 -0.400009      -0.5
all_square reconstructed is -1.52588e-05   0.00999451    0.0399933    0.0899811     0.159988     0.249985      0.35997      0.48999     0.639969     0.809967   0.00999451    0.0399933    0.0899658     0.159988     0.249985      0.35997      0.48999     0.639969     0.809967     0.999985     0.039978    0.0899811     0.159988     0.249985     0.359985     0.489975     0.639969     0.809967     0.999985      1.20998    0.0899658     0.159973     0.249985     0.359985      0.48999     0.639969     0.809982     0.999985      1.20996      1.43997     0.159988     0.249985      0.35997     0.489975     0.639969     0.809967     0.999985      1.20996      1.43997      1.68996
-1.52588e-05   0.00997925     0.039978    0.0899811     0.160004     0.249985     0.360001     0.490005     0.639984     0.809998   0.00997925 -1.52588e-05   0.00999451     0.039978    0.0899811     0.159988     0.249985     0.359985     0.490005     0.639984     0.039978   0.00999451 -1.52588e-05   0.00997925    0.0399933    0.0899963     0.159988     0.249985     0.360001     0.490005    0.0899811     0.039978   0.00999451 -1.52588e-05   0.00999451    0.0399933    0.0899811     0.159988     0.249985     0.359985     0.159973    0.0899811    0.0399933   0.00997925 -1.52588e-05   0.00997925    0.0399933    0.0899963     0.159988     0.249985
all_square reconstructed is -1.52588e-05   0.00999451    0.0399933    0.0899811     0.159988     0.249985      0.35997      0.48999     0.639969     0.809967   0.00999451    0.0399933    0.0899658     0.159988     0.249985      0.35997      0.48999     0.639969     0.809967     0.999985     0.039978    0.0899811     0.159988     0.249985     0.359985     0.489975     0.639969     0.809967     0.999985      1.20998    0.0899658     0.159973     0.249985     0.359985      0.48999     0.639969     0.809982     0.999985      1.20996      1.43997     0.159988     0.249985      0.35997     0.489975     0.639969     0.809967     0.999985      1.20996      1.43997      1.68996
-1.52588e-05   0.00997925     0.039978    0.0899811     0.160004     0.249985     0.360001     0.490005     0.639984     0.809998   0.00997925 -1.52588e-05   0.00999451     0.039978    0.0899811     0.159988     0.249985     0.359985     0.490005     0.639984     0.039978   0.00999451 -1.52588e-05   0.00997925    0.0399933    0.0899963     0.159988     0.249985     0.360001     0.490005    0.0899811     0.039978   0.00999451 -1.52588e-05   0.00999451    0.0399933    0.0899811     0.159988     0.249985     0.359985     0.159973    0.0899811    0.0399933   0.00997925 -1.52588e-05   0.00997925    0.0399933    0.0899963     0.159988     0.249985
all_sum_sq_m reconstructed is  2.84982  3.84981  5.04979  6.44977  8.04973
  2.8499  2.04987  1.44991  1.04987 0.849854
all_sum_sq_m reconstructed is  2.84982  3.84981  5.04979  6.44977  8.04973
  2.8499  2.04987  1.44991  1.04987 0.849854
all_sum_sq reconstructed is  2.84982  3.84981  5.04979  6.44977  8.04973
  2.8499  2.04987  1.44991  1.04987 0.849854
all_sum_sq reconstructed is  2.84982  3.84981  5.04979  6.44977  8.04973
  2.8499  2.04987  1.44991  1.04987 0.849854
norm reconstructed is   0.5914 0.509552 0.444809 0.393661 0.352554
0.593018 0.698975 0.829575 0.970154  1.08867
norm reconstructed is   0.5914 0.509552 0.444809 0.393661 0.352554
0.593018 0.698975 0.829575 0.970154  1.08867
finished inv sqrt tensor
finished inv sqrt tensor
norm reconstructed is   0.5914 0.509552 0.444809 0.393661 0.352554
0.593018 0.698975 0.829575 0.970154  1.08867
norm reconstructed is   0.5914 0.509552 0.444809 0.393661 0.352554
0.593018 0.698975 0.829575 0.970154  1.08867
norm_broadcasted is   0.5914   0.5914   0.5914   0.5914   0.5914   0.5914   0.5914   0.5914   0.5914   0.5914 0.509552 0.509552 0.509552 0.509552 0.509552 0.509552 0.509552 0.509552 0.509552 0.509552 0.444809 0.444809 0.444809 0.444809 0.444809 0.444809 0.444809 0.444809 0.444809 0.444809 0.393661 0.393661 0.393661 0.393661 0.393661 0.393661 0.393661 0.393661 0.393661 0.393661 0.352554 0.352554 0.352554 0.352554 0.352554 0.352554 0.352554 0.352554 0.352554 0.352554
0.593018 0.593018 0.593018 0.593018 0.593018 0.593018 0.593018 0.593018 0.593018 0.593018 0.698975 0.698975 0.698975 0.698975 0.698975 0.698975 0.698975 0.698975 0.698975 0.698975 0.829575 0.829575 0.829575 0.829575 0.829575 0.829575 0.829575 0.829575 0.829575 0.829575 0.970154 0.970154 0.970154 0.970154 0.970154 0.970154 0.970154 0.970154 0.970154 0.970154  1.08867  1.08867  1.08867  1.08867  1.08867  1.08867  1.08867  1.08867  1.08867  1.08867
all_rec size: 100
norm_broadcasted is   0.5914   0.5914   0.5914   0.5914   0.5914   0.5914   0.5914   0.5914   0.5914   0.5914 0.509552 0.509552 0.509552 0.509552 0.509552 0.509552 0.509552 0.509552 0.509552 0.509552 0.444809 0.444809 0.444809 0.444809 0.444809 0.444809 0.444809 0.444809 0.444809 0.444809 0.393661 0.393661 0.393661 0.393661 0.393661 0.393661 0.393661 0.393661 0.393661 0.393661 0.352554 0.352554 0.352554 0.352554 0.352554 0.352554 0.352554 0.352554 0.352554 0.352554
0.593018 0.593018 0.593018 0.593018 0.593018 0.593018 0.593018 0.593018 0.593018 0.593018 0.698975 0.698975 0.698975 0.698975 0.698975 0.698975 0.698975 0.698975 0.698975 0.698975 0.829575 0.829575 0.829575 0.829575 0.829575 0.829575 0.829575 0.829575 0.829575 0.829575 0.970154 0.970154 0.970154 0.970154 0.970154 0.970154 0.970154 0.970154 0.970154 0.970154  1.08867  1.08867  1.08867  1.08867  1.08867  1.08867  1.08867  1.08867  1.08867  1.08867
all_rec size: 100
finished elementwise mul tensor
finished elementwise mul tensor
y reconstructed is        0  3875.45  7751.48  11626.9    15503    19379  23254.4  27130.5  31005.9    34882  3339.09   6678.7  10017.8  13357.4    16697  20036.1  23375.7  26714.8  30054.4    33394  5830.11  8744.94  11660.2  14575.5  17490.3  20405.6  23320.4  26235.7    29151  32065.8  7739.39  10319.4  12899.5  15479.2  18059.2  20638.9  23218.9    25799  28378.7  30958.7  9241.86  11552.5  13862.8  16173.4  18483.7  20794.4    23105  25415.3  27725.9  30036.2
       0 -3886.64 -7773.27 -11659.3   -15546   -19432 -23318.6 -27205.3 -31091.3   -34978  4580.38        0 -4581.08 -9162.16 -13742.5 -18323.6   -22904 -27485.1 -32066.2 -36646.5  10873.2   5436.2        0 -5437.03 -10874.1 -16310.3 -21747.3 -27183.5 -32620.5 -38057.6  19073.2  12715.8  6357.42        0 -6358.39 -12716.8 -19074.2 -25432.6   -31790 -38148.4  28538.4  21403.2  14269.2  7134.05        0 -7135.14 -14270.3 -21404.3 -28539.5 -35673.5
y reconstructed is        0  3875.45  7751.48  11626.9    15503    19379  23254.4  27130.5  31005.9    34882  3339.09   6678.7  10017.8  13357.4    16697  20036.1  23375.7  26714.8  30054.4    33394  5830.11  8744.94  11660.2  14575.5  17490.3  20405.6  23320.4  26235.7    29151  32065.8  7739.39  10319.4  12899.5  15479.2  18059.2  20638.9  23218.9    25799  28378.7  30958.7  9241.86  11552.5  13862.8  16173.4  18483.7  20794.4    23105  25415.3  27725.9  30036.2
       0 -3886.64 -7773.27 -11659.3   -15546   -19432 -23318.6 -27205.3 -31091.3   -34978  4580.38        0 -4581.08 -9162.16 -13742.5 -18323.6   -22904 -27485.1 -32066.2 -36646.5  10873.2   5436.2        0 -5437.03 -10874.1 -16310.3 -21747.3 -27183.5 -32620.5 -38057.6  19073.2  12715.8  6357.42        0 -6358.39 -12716.8 -19074.2 -25432.6   -31790 -38148.4  28538.4  21403.2  14269.2  7134.05        0 -7135.14 -14270.3 -21404.3 -28539.5 -35673.5
y_m reconstructed is -1.52588e-05    0.0591278     0.118256     0.177399     0.236542     0.295685     0.354813     0.413956     0.473099     0.532242    0.0509338     0.101883     0.152847     0.203796     0.254761      0.30571     0.356674     0.407623     0.458588     0.509537    0.0889435     0.133423     0.177917     0.222397     0.266861      0.31134     0.355835     0.400299     0.444794     0.489273     0.118088      0.15744     0.196823     0.236176     0.275558     0.314911     0.354279     0.393646     0.433014     0.472382     0.141006     0.176254     0.211502     0.246765     0.282013     0.317291     0.352539     0.387802      0.42305     0.458298
-1.52588e-05   -0.0593109    -0.118622    -0.177933    -0.237228    -0.296524     -0.35582    -0.415131    -0.474426    -0.533737    0.0698853 -1.52588e-05   -0.0699158    -0.139816    -0.209717    -0.279602    -0.349503    -0.419403    -0.489304    -0.559204     0.165894    0.0829315 -1.52588e-05   -0.0829773    -0.165939    -0.248886    -0.331848     -0.41481    -0.497772    -0.580719     0.291016     0.194016    0.0969849 -1.52588e-05   -0.0970306    -0.194061    -0.291061    -0.388092    -0.485092    -0.582108      0.43544     0.326584     0.217712     0.108841 -1.52588e-05    -0.108887    -0.217773    -0.326614    -0.435486    -0.544342
y_m reconstructed is -1.52588e-05    0.0591278     0.118256     0.177399     0.236542     0.295685     0.354813     0.413956     0.473099     0.532242    0.0509338     0.101883     0.152847     0.203796     0.254761      0.30571     0.356674     0.407623     0.458588     0.509537    0.0889435     0.133423     0.177917     0.222397     0.266861      0.31134     0.355835     0.400299     0.444794     0.489273     0.118088      0.15744     0.196823     0.236176     0.275558     0.314911     0.354279     0.393646     0.433014     0.472382     0.141006     0.176254     0.211502     0.246765     0.282013     0.317291     0.352539     0.387802      0.42305     0.458298
-1.52588e-05   -0.0593109    -0.118622    -0.177933    -0.237228    -0.296524     -0.35582    -0.415131    -0.474426    -0.533737    0.0698853 -1.52588e-05   -0.0699158    -0.139816    -0.209717    -0.279602    -0.349503    -0.419403    -0.489304    -0.559204     0.165894    0.0829315 -1.52588e-05   -0.0829773    -0.165939    -0.248886    -0.331848     -0.41481    -0.497772    -0.580719     0.291016     0.194016    0.0969849 -1.52588e-05   -0.0970306    -0.194061    -0.291061    -0.388092    -0.485092    -0.582108      0.43544     0.326584     0.217712     0.108841 -1.52588e-05    -0.108887    -0.217773    -0.326614    -0.435486    -0.544342
y reconstructed is -1.52588e-05    0.0591278     0.118256     0.177399     0.236542     0.295685     0.354813     0.413956     0.473099     0.532242    0.0509338     0.101883     0.152847     0.203796     0.254761      0.30571     0.356674     0.407623     0.458588     0.509537    0.0889435     0.133423     0.177917     0.222397     0.266861      0.31134     0.355835     0.400299     0.444794     0.489273     0.118088      0.15744     0.196823     0.236176     0.275558     0.314911     0.354279     0.393646     0.433014     0.472382     0.141006     0.176254     0.211502     0.246765     0.282013     0.317291     0.352539     0.387802      0.42305     0.458298
-1.52588e-05   -0.0593109    -0.118622    -0.177933    -0.237228    -0.296524     -0.35582    -0.415131    -0.474426    -0.533737    0.0698853 -1.52588e-05   -0.0699158    -0.139816    -0.209717    -0.279602    -0.349503    -0.419403    -0.489304    -0.559204     0.165894    0.0829315 -1.52588e-05   -0.0829773    -0.165939    -0.248886    -0.331848     -0.41481    -0.497772    -0.580719     0.291016     0.194016    0.0969849 -1.52588e-05   -0.0970306    -0.194061    -0.291061    -0.388092    -0.485092    -0.582108      0.43544     0.326584     0.217712     0.108841 -1.52588e-05    -0.108887    -0.217773    -0.326614    -0.435486    -0.544342
finished zero extend tensor
y reconstructed is -1.52588e-05    0.0591278     0.118256     0.177399     0.236542     0.295685     0.354813     0.413956     0.473099     0.532242    0.0509338     0.101883     0.152847     0.203796     0.254761      0.30571     0.356674     0.407623     0.458588     0.509537    0.0889435     0.133423     0.177917     0.222397     0.266861      0.31134     0.355835     0.400299     0.444794     0.489273     0.118088      0.15744     0.196823     0.236176     0.275558     0.314911     0.354279     0.393646     0.433014     0.472382     0.141006     0.176254     0.211502     0.246765     0.282013     0.317291     0.352539     0.387802      0.42305     0.458298
-1.52588e-05   -0.0593109    -0.118622    -0.177933    -0.237228    -0.296524     -0.35582    -0.415131    -0.474426    -0.533737    0.0698853 -1.52588e-05   -0.0699158    -0.139816    -0.209717    -0.279602    -0.349503    -0.419403    -0.489304    -0.559204     0.165894    0.0829315 -1.52588e-05   -0.0829773    -0.165939    -0.248886    -0.331848     -0.41481    -0.497772    -0.580719     0.291016     0.194016    0.0969849 -1.52588e-05   -0.0970306    -0.194061    -0.291061    -0.388092    -0.485092    -0.582108      0.43544     0.326584     0.217712     0.108841 -1.52588e-05    -0.108887    -0.217773    -0.326614    -0.435486    -0.544342
finished zero extend tensor
Forward pass executed
Forward pass executed
Party 1 L2NormParallel Layer test passed!
Reconstructed Output:
-1.52588e-05    0.0591278     0.118256     0.177399     0.236542     0.295685     0.354813     0.413956     0.473099     0.532242    0.0509338     0.101883     0.152847     0.203796     0.254761      0.30571     0.356674     0.407623     0.458588     0.509537    0.0889435     0.133423     0.177917     0.222397     0.266861      0.31134     0.355835     0.400299     0.444794     0.489273     0.118088      0.15744     0.196823     0.236176     0.275558     0.314911     0.354279     0.393646     0.433014     0.472382     0.141006     0.176254     0.211502     0.246765     0.282013     0.317291     0.352539     0.387802      0.42305     0.458298
-1.52588e-05   -0.0593109    -0.118622    -0.177933    -0.237228    -0.296524     -0.35582    -0.415131    -0.474426    -0.533737    0.0698853 -1.52588e-05   -0.0699158    -0.139816    -0.209717    -0.279602    -0.349503    -0.419403    -0.489304    -0.559204     0.165894    0.0829315 -1.52588e-05   -0.0829773    -0.165939    -0.248886    -0.331848     -0.41481    -0.497772    -0.580719     0.291016     0.194016    0.0969849 -1.52588e-05   -0.0970306    -0.194061    -0.291061    -0.388092    -0.485092    -0.582108      0.43544     0.326584     0.217712     0.108841 -1.52588e-05    -0.108887    -0.217773    -0.326614    -0.435486    -0.544342
Expected Output:
         0  0.0592194   0.118454   0.177689   0.236923   0.296173   0.355392   0.414642   0.473862   0.533112  0.0509491   0.101913   0.152878   0.203842   0.254822   0.305771    0.35675     0.4077   0.458679   0.509644  0.0889893   0.133484   0.177994   0.222488   0.266983   0.311493   0.355988   0.400482   0.444992   0.489487   0.118118   0.157486   0.196869   0.236237    0.27562   0.314987    0.35437   0.393738   0.433121   0.472488   0.140976   0.176224   0.211456   0.246704   0.281952     0.3172   0.352448   0.387695   0.422943   0.458176
         0 -0.0592346  -0.118469  -0.177704  -0.236938  -0.296158  -0.355408  -0.414642  -0.473862  -0.533112  0.0698242          0 -0.0698395  -0.139679  -0.209518  -0.279373  -0.349197  -0.419052  -0.488892  -0.558731   0.166077  0.0830231          0 -0.0830383  -0.166092   -0.24913  -0.332184  -0.415207   -0.49826  -0.581314   0.292755   0.195175    0.09758          0 -0.0975952   -0.19519   -0.29277  -0.390366  -0.487946  -0.585541   0.433853   0.325378   0.216919   0.108444          0  -0.108459  -0.216934  -0.325394  -0.433868  -0.542313
